.. _ernwin_tutorial:

Coarse Grain Tertiary RNA Structure Prediction
==============================================

A Simple Example
~~~~~~~~~~~~~~~~ 

The simplest scenario involves providing a sequence and a secondary structure
as input and obtaining coarse-grain tertiary structures as output. The input
will be a fasta file augmented with secondary structure::

    >2mis
    GAGCUGCAGCACGAAAGUGACGGCUC
    ((((((...(((....))).))))))

With this, we can invoke `ernwin` using the `ernwin_new.py` script::

    ernwin_new.py fastas/2mis.fa

This will start the sampling engine. The default number of iterations is 10000
(although this number can be changed using the `--iterations` flag). Running
`ernwin_new.py` will create an output directory with the id of the provided
sequence (*2mis*, in this case). This directory will contain the top 3 lowest
energy sampled structures. The format for these structures is described in the
documentation of the forgi_ package. They can be visualized using the `visualize_cg.py`
script provided by forgi_::

    visualize_cg.py 2mis/best0.coord

To yield something like this:

.. image:: 2mis_best0.png
    :width: 400
    :align: center

.. _forgi: http://www.tbi.univie.ac.at/~thiel/forgi

We can also compare it to the native structure (in dark green):


.. image:: 2mis_native_and_best.png
    :width: 400
    :align: center

This was generated by first extracting the coarse grain representation from 
the pdb file, then visualizing and aligning (using the `-a` option of `visualize_cg.py`)::

    pdb_to_cg.py ~/projects/ernwin/fess/structures/2mis.pdb > 2mis_native.cg
    visualize_cg.py 2mis/best0.coord 2mis_native.cg -a

Sampling from an Existing CG File
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

For benchmarking purposes, it's often easier to start with the native
structure. This allows one to monitor the RMSD between the current sampled
structure and the native as the simulation progresses. Doing so is almost
identical to starting from a fasta file, wherein the argument to
``ernwin_new.py`` is the cg file instead::

    ernwin_new.py 2mis_native.cg

To create a cg file from a pdb file, see the example in the previous section
or the relevant documentation for the `forgi package <http://www.tbi.univie.ac.at/~thiel/forgi/threedee_tutorial.html#creating-a-coarse-grain-3d-representation-of-an-rna-molecule>`_.


Parsing The Log File
~~~~~~~~~~~~~~~~~~~~~~~

As ernwin runs, it outputs diagnostic information about the sampling procedure. 
The same information can be found in the output folder in the ``out.log`` file


